<!doctype html>
<html lang="ru">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ö–ü</title>

  <style>
    .input-group {
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .col,
    .col-4 {
      margin: 1px;
      overflow: auto;
      max-height: 25vh;
    }

    .row_0>.col {
      max-height: 11vh;
    }

    .print {
      text-align: center;
    }

    .row_end>div {
      padding: 0;
    }

    .tab_flex {
      display: flex;
    }

    p {
      margin-bottom: 0;
    }

    .select {
      background-color: rgba(255, 0, 0, 0.150);
    }

    #clear, #print_form {
      width: 95%;
    }

    #cost_1, #cost_2 {
      text-align: right;
    }
    
    #cost_1 {
      width: 50%;
    }
    
    #cost_2 {
      width: 10%;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        /* display: none; <- Crashes Chrome on hover */
        -webkit-appearance: none;
        margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
    }

    @media all and (orientation: portrait) {

      .input-group-text,
      #print_form {
        display: none;
      }

      .row>* {
        padding: 0;
      }

      div,
      p {
        font-size: 6px;
      }
    }

    @media print {
      @page {
        size: landscape;
      }

      p {
        font-size: 10px;
      }

      .row_0>.col,
      .row_0>.col-4 {
        overflow: hidden;
        font-size: 10px;
        min-height: 26vh;
      }

      .row_org>.col,
      .row_org>.col-4 {
        overflow: hidden;
        min-height: auto;
        max-height: 100vh;
      }

      .tab {
        font-size: 12px;
      }

      .row+.tab {
        margin-top: 15px;
      }

      .cost, #name {
        border: none;
        font-size: 10px;
        height: auto;
        max-width: auto;
        padding-right: 2px;
      }
    }
  </style>

</head>

<body class="bg-light text-dark">
  <h6 class="print d-none d-print-block">–û—Ü–µ–Ω–∫–∞ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, –ø–æ—Å—Ç—É–ø–∏–≤—à–∏—Ö –æ—Ç
    –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –ø–æ –∑–∞–∫—É–ø–∫–µ:</h6>
  <h5 class="print d-none d-print-block" id="pen_1">
    _______________________________________________________________________________________________________________________________
  </h5>
  <p class="print d-none d-print-block" id="pen_2">–í–∏–¥ –∑–∞–∫—É–ø–∫–∏, –Ω–æ–º–µ—Ä –∏–ª–∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∑–∞–∫—É–ø–∫–∏, –Ω–∞—á–∞–ª—å–Ω–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ </p>
  <h5 class="print d-none d-print-block" id="pen_3">
    _______________________________________________________________________________________________________________________________
  </h5>

  <div class="container-fluid container-all">

    <form class="row g-3">
      <div class="col-sm-7">
        <div class="input-group input-group-large">
          <textarea type="text" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∑–∞–∫—É–ø–∫–∏" rows="3" id="name"></textarea>
        </div>
      </div>

      <div class="col-sm-3">
        <div class="input-group input-group-large">
          <input type="number" min="0" class="form-control cost" placeholder="0" id="cost_1">
          <span class="input-group-text cost" id="cost_text_1">—Ä—É–±.</span>
          <input type="number" min="0" max="99" class="form-control cost" placeholder="00" id="cost_2">
          <span class="input-group-text cost" id="cost_text_2">–∫–æ–ø.</span>

        </div>

        <div class="input-group input-group-large">
          <input type="text" class="form-control d-print-none" id="inputInn" placeholder="–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù"
            aria-label="Recipient's username">
        </div>
      </div>

      <div class="col-sm-2 d-print-none">
        <div class="input-group input-group-large d-print-none">
          <div class="col-sm d-print-none">
            <button class="btn btn-outline-success d-print-none" type="button" id="print_form">–ü–µ—á–∞—Ç—å</button>
          </div>
          
          <div class="col-sm d-print-none" align="right">
            <button class="btn btn-outline-success d-print-none" type="button" id="clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
          
        <div class="d-grid gap-2 col-6 input-group input-group-large d-print-none">
          <button class="btn btn-outline-success d-print-none" type="button" id="search">–ü–æ–∏—Å–∫</button>
        </div>
      </div> 
    </form>

    <div class="container-fluid">
      <div class="row row_0">
        <div class="col border">
          –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Æ–õ –∏–ª–∏ –ò–ü**
        </div>
        <div class="col border">
          –°–≤–µ–¥–µ–Ω–∏—è –æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –Æ–õ, –ª–∏–±–æ –æ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ò–ü
        </div>
        <div class="col-4 border">
          –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤–∏–¥–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –û–ö–í–≠–î —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –≤ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏* –æ—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
        </div>
        <div class="col border">
          –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤–µ–¥–µ–Ω–∏–π –æ –Æ–õ, –ª–∏–±–æ –æ–± –ò–ü –≤ —Ä–µ–µ—Å—Ç—Ä–µ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
        </div>
        <div class="col border">
          –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ—à–µ–Ω–∏—è –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω–æ–≥–æ —Å—É–¥–∞ –æ –ø—Ä–∏–∑–Ω–∞–Ω–∏–∏ –Æ–õ –∏–ª–∏ –ò–ü –±–∞–Ω–∫—Ä–æ—Ç–æ–º
        </div>
        <div class="col border">
          –°–≤–µ–¥–µ–Ω–∏—è –æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –Æ–õ –∏–ª–∏ –ò–ü, –ø–æ–¥–∞–≤—à–∏—Ö –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è*, –≤ —Å–æ—Å—Ç–∞–≤–µ —É—á—Ä–µ–¥–∏—Ç–µ–ª–µ–π –Æ–õ,
          —Ç–∞–∫–∂–µ –ø–æ–¥–∞–≤—à–µ–≥–æ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ* –ø–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É –∑–∞–∫—É–ø–∫–∏
        </div>
      </div>
    </div>
  </div>

  <div class="container-fluid d-none d-print-block tab">
    <div class="row d-none d-print-block">
      <div class="col d-none d-print-block">* - —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è,
        –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –∂—É—Ä–Ω–∞–ª–µ –≤—Ö–æ–¥—è—â–µ–π –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ü–∏–∏ –≤ –∫–∞–Ω—Ü–µ–ª—è—Ä–∏–∏ —É—á—Ä–µ–∂–¥–µ–Ω–∏—è.</div>
      <div class="col d-none d-print-block">** - —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Æ–õ –∏ –ò–ü, –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–±—Ä–∞–Ω—ã –¥–ª—è
        –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã –∑–∞–∫—É–ø–∫–∏.</div>
    </div>
    <div class="row d-none tab">
      <div class="col-auto d-none d-print-block tab">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏ <br> –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</div>
      <div class="col-auto d-none d-print-block tab" align="center">______________________________</div>
      <div class="col-auto d-none d-print-block tab">_____________________________________</div>
      <div class="col-auto d-none d-print-block tab" align="center">_________</div>
      <div class="col-auto d-none d-print-block tab">_________</div>
      <div class="col-auto d-none d-print-block tab data_screen" align="center">_________ /_________ /20_________</div>
    </div>
  </div>

  <script>
    let organisations = [];
    let dataArr;
    let screenNum = 0;
    setFocus();

    function setFocus() {
      document.getElementById("name").focus();
    }

    document.addEventListener('keydown', function (event) {
      if ((event.code == 'Enter' || event.code == 'NumpadEnter')) {
        if (document.activeElement.id == "inputInn") {
          search.onclick();
        }
      }
    });
    
    search.onclick = function () {
      urlGeneration("inputInn");
      document.getElementById("inputInn").value = "";
      document.getElementById("inputInn").focus();
    }

    function urlGeneration(input) {
	  let userKey = prompt("–í–≤–µ–¥–∏—Ç–µ –í–∞—à API-–∫–ª—é—á, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ ofdata.ru");
      let inn = document.getElementById(input).value;
      let url;
      if (inn.length == 10) {
		url = "https://api.ofdata.ru/v2/company?key=" + `${userKey}` + "&inn=" + inn;
      } else if (inn.length == 12) {
        url = "https://api.ofdata.ru/v2/entrepreneur?key=" + `${userKey}` + "&inn=" + inn;
      } else {
		alert("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ò–ù–ù!\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–≤–µ—Å—Ç–∏ –ò–ù–ù –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (10 —Ü–∏—Ñ—Ä)\n–∏–ª–∏ –ò–ù–ù –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–µ–Ω–∏–º–∞—Ç–µ–ª—è (12 —Ü–∏—Ñ—Ä)!");
	  }
      getServerData(inn, url);
    }

    function getServerData(inn, url) {
      fetch(`http://api.allorigins.win/get?url=${encodeURIComponent(url)}`)
        .then(response => {
          if (response.ok) return response.json()
          throw new Error('Network response was not ok.')
        })
        .then(data => {
          dataArr = JSON.parse(data.contents);
          organisations.push(dataArr);
        })
        .then(data => {
          searchChange(organisations.length);
        });
    }

    function searchChange (numOrg) {
      let search = document.querySelector("#search");
      let searchNum = 0;
      for (let i = 0; i < numOrg; i++) {
        if (organisations[i].meta.today_request_count > searchNum) {
          searchNum = organisations[i].meta.today_request_count;
        } 
      }
      search.innerHTML = "–ü–æ–∏—Å–∫ (–æ—Å—Ç–∞–ª–æ—Å—å: " + `${100 - searchNum}` + ")"; 
      createNewDiv(numOrg);
    }

    function createNewDiv(numOrg) {
      let parentGrid = document.querySelector('.container-all');
      let createBox = document.createElement('div');
      let currentLine = "line_" + `${numOrg}`;
      createBox.className = "container-fluid bg-white " + `${currentLine}`;
      currentLine = "." + currentLine;
      parentGrid.appendChild(createBox);
      createNewLine(numOrg, currentLine);
    }

    function createNewLine(numOrg, currentLine) {
      let parentGrid = document.querySelector(`${currentLine}`);
      let createBox = document.createElement('div');
      createBox.className = "row row_org row_" + `${numOrg}`;
      parentGrid.appendChild(createBox);
      createNewLineOrg(numOrg);
    }

    function createNewLineOrg(numOrg) {
      for (let i = 1; i < 7; i++) {
        let parentGrid = document.querySelector(".row_" + `${numOrg}`);
        let createBox = document.createElement('div');
        if (i == 3) {
          createBox.className = "col-4 border org" + `${numOrg}` + "_" + i;
        } else {
          createBox.className = "col border org" + `${numOrg}` + "_" + i;
        }
        createBox.innerHTML = '<p id="org' + `${numOrg}` + "_" + i + '">' + '</p>';
        parentGrid.appendChild(createBox);
        let a = document.querySelector(".org" + `${numOrg}` + "_" + i);
        // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è —è—á–µ–π–∫–∏ –ø–æ –∫–ª–∏–∫—É
        a.onclick = function () {
          if (a.className.includes('select')) {
            createBox.classList.remove('select');
          } else {
            createBox.classList.add('select');
          }
        };
      }
      if (organisations[numOrg - 1].data.–ò–ù–ù.length == 10) {
        onScreenOrg(organisations.length);
      } else if (organisations[numOrg - 1].data.–ò–ù–ù.length == 12) {
        onScreenIP(organisations.length);
      }
      if (organisations.length > 1) {
        searchLink(organisations.length);
      }
    }

    function onScreenOrg(numOrg) {
      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–≤–µ–¥–µ–Ω–∏–π –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
      console.log("üöÄ ~ onScreen ~ organisations", organisations)
      let orgInfo = "<b>" + organisations[numOrg - 1].data.–ù–∞–∏–º–°–æ–∫—Ä + "</b>" + `${"<br />"}` + `${"<br />"}`;
      orgInfo += "–ò–ù–ù: " + organisations[numOrg - 1].data.–ò–ù–ù + `${"<br />"}` + `${"<br />"}`;
      orgInfo += "–û–ì–†–ù: " + organisations[numOrg - 1].data.–û–ì–†–ù + `${"<br />"}` + `${"<br />"}`;
      orgInfo += organisations[numOrg - 1].data.–Æ—Ä–ê–¥—Ä–µ—Å.–ê–¥—Ä–µ—Å–†–§;

      document.querySelector("#org" + `${numOrg}` + "_" + 1).innerHTML = orgInfo;

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
      if (organisations[numOrg - 1].data.–õ–∏–∫–≤–∏–¥) {
        document.querySelector("#org" + `${numOrg}` + "_" + 2).innerHTML = "–ù–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç." + `${"<br />"}` + `${"<br />"}` + " –î–∞—Ç–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏: " + organisations[numOrg - 1].data.–õ–∏–∫–≤–∏–¥.–î–∞—Ç–∞;
        document.querySelector(".org" + `${numOrg}` + "_" + 2).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 2).innerHTML = "–î–µ–π—Å—Ç–≤—É–µ—Ç";
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –û–ö–í–≠–î
      let okvedArr_value = () => {
        okvedArr_value = organisations[numOrg - 1].data.–û–ö–í–≠–î.–ö–æ–¥ + " " + organisations[numOrg - 1].data.–û–ö–í–≠–î.–ù–∞–∏–º + `${"<br />"}`;
        for (let i = 0; i < organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø.length; i++) {
          okvedArr_value += organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø[i].–ö–æ–¥ + " " + organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø[i].–ù–∞–∏–º + `${"<br />"}`;
        }
        return okvedArr_value;
      }
      document.querySelector("#org" + `${numOrg}` + "_" + 3).innerHTML = okvedArr_value();

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
      if (organisations[numOrg - 1].data.–ù–µ–¥–æ–±–ü–æ—Å—Ç == true) {
        let dataPub = "–ó–∞–ø–∏—Å–∏: " + `${"<br />"}`;
        organisations[numOrg - 1].data.–ù–µ–¥–æ–±–ü–æ—Å—Ç–ó–∞–ø.forEach((item) => {
          dataPub += item.–†–µ–µ—Å—Ç—Ä–ù–æ–º–µ—Ä + " –æ—Ç " + item.–î–∞—Ç–∞–ü—É–± + "; " + `${"<br />"}`;
        });
        document.querySelector("#org" + `${numOrg}` + "_" + 4).innerHTML = "–í–∫–ª—é—á–µ–Ω –≤ —Ä–µ–µ—Å—Ç—Ä –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤." + `${"<br />"}` + dataPub;
        document.querySelector(".org" + `${numOrg}` + "_" + 4).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 4).innerHTML = "–°–≤–µ–¥–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫—Ä–æ—Ç–æ–≤
      if (organisations[numOrg - 1].data.–°—Ç–∞—Ç—É—Å.–ö–æ–¥ == 117) {
        document.querySelector("#org" + `${numOrg}` + "_" + 5).innerHTML = organisations[numOrg - 1].data.–°—Ç–∞—Ç—É—Å.–ù–∞–∏–º;
        document.querySelector(".org" + `${numOrg}` + "_" + 5).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else if (organisations[numOrg - 1].data.–õ–∏–∫–≤–∏–¥) {
        document.querySelector("#org" + `${numOrg}` + "_" + 5).innerHTML = organisations[numOrg - 1].data.–õ–∏–∫–≤–∏–¥.–ù–∞–∏–º;
        document.querySelector(".org" + `${numOrg}` + "_" + 5).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 5).innerHTML = "–°–≤–µ–¥–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤—è–∑–µ–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –∏ —É—á—Ä–µ–¥–∏—Ç–µ–ª–µ–π
      let dataBoss = "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å: " + `${"<br />"}`;
      organisations[numOrg - 1].data.–†—É–∫–æ–≤–æ–¥.forEach((item) => {
        dataBoss += item.–§–ò–û + `${"<br />"}` + "(–ò–ù–ù: " + item.–ò–ù–ù + ")" + `${"<br />"}` + `${"<br />"}`;
      });
      if (organisations[numOrg - 1].data.–£—á—Ä–µ–¥.–§–õ.length > 0) {
        dataBoss += "–£—á—Ä–µ–¥–∏—Ç–µ–ª–∏: " + `${"<br />"}`;
        organisations[numOrg - 1].data.–£—á—Ä–µ–¥.–§–õ.forEach((item) => {
          dataBoss += item.–§–ò–û + `${"<br />"}` + "(–ò–ù–ù: " + item.–ò–ù–ù + ")" + `${"<br />"}` + `${"<br />"}`;
        });
      }
      document.querySelector("#org" + `${numOrg}` + "_" + 6).innerHTML = dataBoss;
    }

    function onScreenIP(numOrg) {
      console.log(organisations)

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–≤–µ–¥–µ–Ω–∏–π –æ–± –ò–ü
      let orgInfo = "<b>" + "–ò–ü " + organisations[numOrg - 1].data.–§–ò–û + "</b>" + `${"<br />"}` + `${"<br />"}`;
      orgInfo += "–ò–ù–ù: " + organisations[numOrg - 1].data.–ò–ù–ù + `${"<br />"}` + `${"<br />"}`;
      orgInfo += "–û–ì–†–ù–ò–ü: " + organisations[numOrg - 1].data.–û–ì–†–ù–ò–ü + `${"<br />"}` + `${"<br />"}`;
      orgInfo += organisations[numOrg - 1].data.–†–µ–≥–∏–æ–Ω.–ù–∞–∏–º + ", " + organisations[numOrg - 1].data.–ù–∞—Å–ü—É–Ω–∫—Ç;
      document.querySelector("#org" + `${numOrg}` + "_" + 1).innerHTML = orgInfo;

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –ò–ü
      if (organisations[numOrg - 1].data.–ü—Ä–µ–∫—Ä–∞—â) {
        document.querySelector("#org" + `${numOrg}` + "_" + 2).innerHTML = "–ù–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç." + `${"<br />"}` + `${"<br />"}` + " –î–∞—Ç–∞ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: " + organisations[numOrg - 1].data.–ü—Ä–µ–∫—Ä–∞—â.–î–∞—Ç–∞;
        document.querySelector(".org" + `${numOrg}` + "_" + 2).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 2).innerHTML = "–î–µ–π—Å—Ç–≤—É–µ—Ç";
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –û–ö–í–≠–î
      let okvedArr_value = () => {
        okvedArr_value = organisations[numOrg - 1].data.–û–ö–í–≠–î.–ö–æ–¥ + " " + organisations[numOrg - 1].data.–û–ö–í–≠–î.–ù–∞–∏–º + `${"<br />"}`;
        for (let i = 0; i < organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø.length; i++) {
          okvedArr_value += organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø[i].–ö–æ–¥ + " " + organisations[numOrg - 1].data.–û–ö–í–≠–î–î–æ–ø[i].–ù–∞–∏–º + `${"<br />"}`;
        }
        return okvedArr_value;
      }
      document.querySelector("#org" + `${numOrg}` + "_" + 3).innerHTML = okvedArr_value();

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
      if (organisations[numOrg - 1].data.–ù–µ–¥–æ–±–ü–æ—Å—Ç == true) {
        document.querySelector("#org" + `${numOrg}` + "_" + 4).innerHTML = "–í–∫–ª—é—á–µ–Ω –≤ —Ä–µ–µ—Å—Ç—Ä –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤." + `${"<br />"}` + `${"<br />"}` + "–í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π: " + organisations[numOrg - 1].data.–ù–µ–¥–æ–±–ü–æ—Å—Ç–ó–∞–ø.length;
        document.querySelector(".org" + `${numOrg}` + "_" + 4).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 4).innerHTML = "–°–≤–µ–¥–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫—Ä–æ—Ç–æ–≤
      if (organisations[numOrg - 1].data.–ü—Ä–µ–∫—Ä–∞—â) {
        document.querySelector("#org" + `${numOrg}` + "_" + 5).innerHTML = organisations[numOrg - 1].data.–ü—Ä–µ–∫—Ä–∞—â.–ù–∞–∏–º;
        document.querySelector(".org" + `${numOrg}` + "_" + 5).classList.add("border-danger", "border-4");
        document.querySelector(".org" + `${numOrg}` + "_" + 1).classList.add("border-danger", "border-4");
      } else {
        document.querySelector("#org" + `${numOrg}` + "_" + 5).innerHTML = "–°–≤–µ–¥–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
      }

      // –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤—è–∑–µ–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –∏ —É—á—Ä–µ–¥–∏—Ç–µ–ª–µ–π
      let dataBoss = organisations[numOrg - 1].data.–§–ò–û + `${"<br />"}` + `${"<br />"}` + "(–ò–ù–ù: " + organisations[numOrg - 1].data.–ò–ù–ù + ")";
      document.querySelector("#org" + `${numOrg}` + "_" + 6).innerHTML = dataBoss;
    }

    function searchLink(numOrg) {
      let searchLinkBoss = [];
      for (let i = 0; i <= (numOrg - 1); i++) {
        searchLinkBoss[i] = [];
        organisations[i].data.–†—É–∫–æ–≤–æ–¥.forEach((item) => {
          searchLinkBoss[i].push(item.–ò–ù–ù);
        });
        organisations[i].data.–£—á—Ä–µ–¥.–§–õ.forEach((item) => {
          if (!searchLinkBoss[i].includes(item.–ò–ù–ù)) {
            searchLinkBoss[i].push(item.–ò–ù–ù);
          }
        });
      }
      for (let i = 0; i <= (numOrg - 1); i++) {
        searchLinkBoss[i].forEach((item) => {
          for (let j = i + 1; j <= (numOrg - 1); j++) {
            searchLinkBoss[j].forEach((item_2) => {
              if (item === item_2) {
                document.querySelector(".org" + `${i + 1}` + "_" + 6).classList.add("border-danger", "border-4");
                document.querySelector(".org" + `${j + 1}` + "_" + 6).classList.add("border-danger", "border-4");
                document.querySelector(".org" + `${i + 1}` + "_" + 1).classList.add("border-danger", "border-4");
                document.querySelector(".org" + `${j + 1}` + "_" + 1).classList.add("border-danger", "border-4");
              }
            });
          }
        });
      }
    }

    print_form.onclick = function () {
      let classArr = document.querySelectorAll(".tab")
      for (let i = 0; i < classArr.length; i++) {
        classArr[i].classList.remove("d-none");
        classArr[i].classList.add("tab_flex");
        classArr[i].classList.add("align-items-end");
      }

      for (let i = 0; i < organisations.length; i++) {
        for (let j = 1; j <= 6; j++) {
          let currentBox = document.querySelector(".org" + `${i + 1}` + "_" + j);
          if (!currentBox.className.includes('select')) {
            switch (j) {
              case 1:
                let index = currentBox.innerHTML.indexOf("<br><br>–û–ì–†–ù");
                currentBox.innerHTML = currentBox.innerHTML.slice(0, index);
                index = currentBox.innerHTML.indexOf("<br>");
                currentBox.innerHTML = currentBox.innerHTML.slice(0, index) + currentBox.innerHTML.slice(index + 4);
                break;
              case 2:
                currentBox.innerHTML = "<p align='center'>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>";
                break;
              case 3:
                currentBox.innerHTML = "<p align='center'>—Å–æ–≤–ø–∞–¥–∞—é—Ç</p>";
                break;
              case 4:
                currentBox.innerHTML = "<p align='center'>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>";
                break;
              case 5:
                currentBox.innerHTML = "<p align='center'>–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</p>";
                break;
              case 6:
                currentBox.innerHTML = "<p align='center'>–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>";
                break;
            }
          } else {
            switch (j) {
              case 1:
                let index = currentBox.innerHTML.indexOf("<br><br>–û–ì–†–ù");
                currentBox.innerHTML = currentBox.innerHTML.slice(0, index);
                index = currentBox.innerHTML.indexOf("<br>");
                currentBox.innerHTML = currentBox.innerHTML.slice(0, index) + currentBox.innerHTML.slice(index + 4);
                break;
              case 2:
                currentBox.innerHTML = "<p align='center'><b>–Ω–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç</b></p>";
                break;
              case 3:
                currentBox.innerHTML = "<p align='center'><b>–≤–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç</b></p>";
                break;
              case 4:
                currentBox.innerHTML = "<p align='center'><b>—Å–æ—Å—Ç–æ–∏—Ç –≤ —Ä–µ–µ—Å—Ç—Ä–µ</b></p>";
                break;
              case 5:
                currentBox.innerHTML = "<p align='center'><b>–±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ –∏/–∏–ª–∏ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏</b></p>";
                break;
              case 6:
                currentBox.innerHTML = "<p align='center'><b>–Ω–∞–π–¥–µ–Ω—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</b></p>";
                break;
            }
          }
        }
      }

      for (let i = 0; i < organisations.length; i++) {
        for (let j = 1; j <= 6; j++) {
          let currentBox = document.querySelector(".org" + `${i + 1}` + "_" + j);
          if (currentBox.className.includes('border-danger')) {
            currentBox.classList.remove('border-danger');
          }
          if (currentBox.className.includes('border-4')) {
            currentBox.classList.remove('border-4');
          }
        }
      }
      
      if (!document.querySelector('#name').value) {
        document.querySelector('#name').classList.add("d-print-none");
      } else {
        document.querySelector('#pen_1').classList.add("d-print-none");
        document.querySelector('#pen_2').classList.add("d-print-none");
        document.querySelector('#pen_3').classList.add("d-print-none");
      }

      if (!document.querySelector('#cost_1').value) {
        document.querySelector('#cost_1').classList.add("d-print-none");
        document.querySelector('#cost_text_1').classList.add("d-print-none");
      }

      if (document.querySelector('#cost_1').value && !document.querySelector('#cost_2').value) {
        document.querySelector('#cost_2').value = "00";
      } else if (!document.querySelector('#cost_2').value) {
        document.querySelector('#cost_2').classList.add("d-print-none");
        document.querySelector('#cost_text_2').classList.add("d-print-none");
      } 
      
      window.print();
    }

    clear.onclick = function () {
      location.reload();
    }

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
</body>

</html>